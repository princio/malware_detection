import csv
import os


def formatTab(dataset_name):

    with open('dataset_reale/benign_h_t/' + str(dataset_name) + '__h_t.csv', 'a', newline = '') as dataset_final:
        writer = csv.writer(dataset_final)

        with open(str(dir) + str(dataset_name)) as dataset:
            dataset_read = csv.reader(dataset, delimiter=",")

            for riga in dataset_read:
                if len(riga)>0:
                    url = riga[1].split('.')

                    if riga[6] == 'YES':
                        if url[0]=='www':
                            writer.writerow(['legit', 'alexa', str(url[0]).lower() + str(url[1]).lower() + str(url[-1]).lower(), str(riga[1]).lower()])
                        else:
                            writer.writerow(['legit','alexa',str(url[0]).lower()+str(url[-1]).lower(), str(riga[1]).lower()])

                    if riga[6] == 'NO':
                        if url[0] == 'www':
                            writer.writerow(['legit', str(riga[3]).lower(), str(url[0]).lower() + str(url[1]).lower() + str(url[-1]).lower(), str(riga[1]).lower()])
                        else:
                            writer.writerow(['legit', str(riga[3]).lower(), str(url[0]).lower() + str(url[-1]).lower(), str(riga[1]).lower()])

            writer.writerow(['legit', 'alexa', 'thelongestdomainnameintheworldandthensomeandthensomemoreandmorecom','thelongestdomainnameintheworldandthensomeandthensomemoreandmore.com'])

dir = 'dataset_reale/benign/'
lista_file = os.listdir(dir)

for file in lista_file:
    formatTab(file)