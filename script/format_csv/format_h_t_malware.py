import csv
import os

# dataset_name = '25_2014-02-07_capture-win3.pcap_table'

def formatTab(dataset_name):

    with open('dataset_namirial/' + str(dataset_name) + '__h_t.csv', 'a', newline = '') as dataset_final:
        writer = csv.writer(dataset_final)

        with open(str(dir) + str(dataset_name)) as dataset:
            dataset_read = csv.reader(dataset, delimiter=",")

            for riga in dataset_read:
                if len(riga)>0:
                    url = riga[1].split('.')

                    if riga[6] == 'YES':
                        if url[0]=='www':
                            writer.writerow(['legit', 'alexa', str(url[0]) + str(url[1]) + str(url[-1]), riga[1]])
                        else:
                            writer.writerow(['legit','alexa',str(url[0])+str(url[-1]), riga[1]])

                    if riga[6] == 'NO':
                        if url[0] == 'www':
                            writer.writerow(['dga', riga[3], str(url[0]) + str(url[1]) + str(url[-1]), riga[1]])
                        else:
                            writer.writerow(['dga', riga[3], str(url[0]) + str(url[-1]), riga[1]])

            writer.writerow(['legit', 'alexa', 'thelongestdomainnameintheworldandthensomeandthensomemoreandmorecom','thelongestdomainnameintheworldandthensomeandthensomemoreandmore.com'])

dir = 'dataset_reale/malware/'
lista_file = os.listdir(dir)

for file in lista_file:
    formatTab(file)