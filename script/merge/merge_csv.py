import csv

filename = 'domains_with_family'+'.csv'
path1 = 'malware_h_t/' + filename
path2 = 'malware_probability/Proba_' + filename + '__h_t.csv'
path_final = 'malware_final/'

def csv_merge(csvr_a, csvr_b, csvw_out):
    for row_a, row_b in zip(csvr_a, csvr_b):
        csvw_out.writerow(row_a + row_b)

file1 = open(path1,'r')
list = csv.reader(file1)

file2 = open(path2,'r')
prob = csv.reader(file2, delimiter=",")
csv_out = csv.writer(open(path_final + filename + '_final.csv', "w", newline=''))
csv_merge(list, prob, csv_out)