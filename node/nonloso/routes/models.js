var express = require('express');
var router = express.Router();
var fs = require('fs');
 

/* GET users listing. */
router.get('/', function(req, res, next) {

    const db_name = req.originalUrl.split('/')[1];

    let rawdata = fs.readFileSync(__dirname + '/../../../databases/' + db_name + '/models.json');
    let models = JSON.parse(rawdata);

    res.render('models', {models});
});

router.get('/:id', async function(req, res, next) {
    const model = await Model.fetch(req.params.id);

    await model.fetch_reports();

    res.render('models/model', {model});
});

module.exports = router;
