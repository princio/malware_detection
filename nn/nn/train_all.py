
import trainer
import os
from datetime import datetime


if __name__ == "__main__":

    dataset_path = os.path.join(os.getcwd(), 'dataset_training.csv')

    _now = datetime.now().strftime("%Y%m%d_%H%M%S")

    output_dir = '/home/michelle/Repo/nns/'

    config = trainer.TrainingConfiguration(
        output_dir=output_dir,
        dataset_path='dataset_training.csv',
        folds=8,
        epochs=20,
        lstm_units=256,
        model_name=f'{_now}_',
        batch_size=128,
        input_max_len=60,
        psl_remove='NONE'
    )

    psls = [ 'NONE', 'PRIVATE', 'ICANN', 'TLD' ]

    if os.environ.get('DEBUG'):
        config.folds = 1
        config.epochs = 1
        psls = [ 'NONE' ]

    for psl_remove in psls:
        config.output_dir = output_dir
        config.psl_remove = psl_remove
        trainer.perform(config)

    pass
