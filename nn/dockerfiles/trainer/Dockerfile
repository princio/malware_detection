FROM tensorflow/tensorflow:latest-gpu

RUN pip install pandas keras sklearn tldextract openpyxl tabulate

#openpyxl: driver for Excel files
RUN mkdir trainer

COPY ./dataset/dataset_training.csv /trainer/

COPY ./mwdb/*.py /trainer/

WORKDIR /trainer
RUN mkdir models

ENV DEBUG="False"
RUN mkdir /trainer/.cache && chmod 777 /trainer/.cache
ENV TLDEXTRACT_CACHE="/trainer/.cache"

ENV TF_CPP_MIN_LOG_LEVEL=3

RUN /bin/bash -c 'pip freeze > /trainer/models/requirements.txt'

ENTRYPOINT [ "python3", "trainer.py", "dataset_training.csv",  "models/" ]
