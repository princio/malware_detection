<template>
  <div class="configs">
    <table class="center">
        <thead>
            <tr>
                <th>model</th>
                <th>wsize</th>
                <th>top10m</th>
                <th>windowing</th>
                <th>replace value</th>
            </tr>
        </thead>
      <tbody>
        <tr v-for="n in config.length" :key="`comparer_${n}`">
          <td>
            <div class="row">
              <select
                v-model="config[n - 1].model">
                <option v-for="model in configs.models" :key="`select_wsize_${n}_${model}`" :value="model">
                  {{ model }}
                </option>
              </select>
            </div>
          </td>
          <td>
            <div class="row">
              <select
                v-model.number="config[n - 1].wsize">
                <option v-for="_wsize_ in configs.wsize" :key="`select_wsize_${n}_${_wsize_}`" :value="_wsize_">
                  {{ _wsize_ }}
                </option>
              </select>
            </div>
          </td>
          <td>
            <div class="row">
              <select
                v-model="config[n - 1].top10m">
                <option v-for="_top10m_ in configs.top10m" :key="`select_top10m_${n}_${_top10m_}`" :value="_top10m_">
                  {{ _top10m_[0] }}, {{ _top10m_[1] }}
                </option>
              </select>
            </div>
          </td>
          <td>
            <div class="row">
              <select
                v-model="config[n - 1].windowing">
                <option v-for="_windowing_ in configs.windowing" :key="`select_windowing_${n}_${_windowing_}`" :value="_windowing_">
                  {{ _windowing_ }}
                </option>
              </select>
            </div>
          </td>
          <td>
            <div class="row">
              <select v-if="config[n - 1].model !== 'nx'"
                v-model="config[n - 1].replace_value">
                <option v-for="(_rp_, i) in configs.replace_values.llr" :key="`select_rp_${n}_llr_${i}`" :value="_rp_">
                  {{ _rp_[0] }}, 
                  {{ _rp_[1] }}
                </option>
              </select>
              <select v-else
                v-model="config[n - 1].replace_value">
                <option v-for="(_rp_, i) in configs.replace_values.nx" :key="`select_rp_${n}_nx_${i}`" :value="_rp_">
                  {{ convert_lambda[_rp_[0]] }}, 
                  {{ convert_lambda[_rp_[1]] }}
                </option>
              </select>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    
  </div>
</template>

<script>
const axios = require("axios");



export default {
  name: "ConfigBar",
  data: function () {
    this.ths_measures = {};
    this.convert_lambda = {
      0: 0,
      1: 1,
      '-6.906754778648554': '位(0.001)',
      2.1972245773362196: '位(0.9)',
      6.906754778648553: '位(0.999)',
      13.815509557935018: '位(0.999999)'
    }
    return {
      configs: {},
      config: [
        {
            model: 'icann',
            wsize: 500,
            windowing: 'both',
            top10m: [ 0, 0 ],
            replace_value: [ -20, 20 ]
        },
        {
            model: 'nx',
            wsize: 500,
            windowing: 'both',
            top10m: [ 0, 0 ],
            replace_value: [ 0, 1 ]
        }
      ],
    };
  },
  async mounted() {
    await this.configs_fetch();
  },
  methods: {
    configs_changed() {
      if (Object.keys(this.configs).length === 0) return;

      this.configs_checked = Object.keys(this.configs).reduce((aps, hash) => {
        const ap = this.configs[hash];
        ap.hash = hash;
        if (ap.checked) aps.push(ap);
        return aps;
      }, []);
    },
    async configs_fetch() {
      this.configs = (
        await axios.get("http://127.0.0.1:3000/mwdb/configs")
      ).data.configs;

      console.log(this.configs.replace_values)
    },
  },
};
</script>


<style scoped>
.active {
  background-color: lightskyblue;
}
.boldd {
  font-weight: bold;
  font-size: 16px;
}
.center {
  text-align: center;
  margin: auto;
}
#app > div.configs > table > tbody {
  text-align: left;
}
table > tbody > tr > td,
th {
  text-align: left;
}
</style>