FROM tensorflow/tensorflow:latest-gpu

RUN pip install pandas keras sklearn tldextract openpyxl tabulate

#openpyxl: driver for Excel files

COPY ./*.py /trainer/
COPY ./top_10m.dsfx.pkl /trainer/
COPY ./stratosphere_malware.csv /trainer/

WORKDIR /trainer

ENV DEBUG="False"
RUN mkdir /trainer/.cache && chmod 777 /trainer/.cache
ENV TLDEXTRACT_CACHE="/trainer/.cache"

ENV TF_CPP_MIN_LOG_LEVEL=3

RUN pip freeze > ./models/requirements.txt

ENTRYPOINT ["python3"]
