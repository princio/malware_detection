<template>
  <div id="app">
    <div style="display: flex; flex-direction: row; width: 500px; space-between: fill; justify-content: space-between;">
      <div style="display: flex; flex-direction: column; text-align: left;">
        <div v-for="fx in fxs" :key="fx">
          <input type="checkbox" :id="fx" :value="fx" v-model="checkedFxs" />
          <label :for="fx">{{ fx }} </label>
        </div>
      </div>
      <div style="display: flex; flex-direction: column; text-align: left;">
        <div v-for="size in sizes" :key="size">
          <input type="checkbox" :id="size" :value="size" v-model="checkedSizes"/>
          <label :for="size">{{ size }} </label>
        </div>
      </div>
      <div style="display: flex; flex-direction: column; text-align: left;">
        <div v-for="dga in dgas" :key="dga">
          <input type="checkbox" :id="dga" :value="dga" v-model="checkedDgas"/>
          <label :for="dga">{{ dga }} </label>
        </div>
      </div>
      <div style="display: flex; flex-direction: column; text-align: left;">
        <div>
          <label :for="llr_th">$th_{\lambda}$ </label>
          <select name="llr_th" id="llr_th" v-model="llr_th">
            <option v-for="th in llr_ths" :key="th">{{ th }}</option>
          </select>
        </div>
        <div>
          <label :for="nx_th">$th_{nx}$ </label>
          <select name="nx_th" id="nx_th" v-model="nx_th">
            <option v-for="th in nx_ths" :key="th">{{ th }}</option>
          </select>
        </div>
        <div>
          <label :for="ctr_th">$th_{ctr}$ </label>
          <select name="ctr_th" id="ctr_th" v-model="ctr_th">
            <option v-for="th in ctr_ths" :key="th">{{ th }}</option>
          </select>
        </div>
        <button v-on:click="reload()">Reload</button>
      </div>
    </div>
    <div ref="mathJaxEl" v-html="compiledHtml"></div>
  </div>
</template>

<script>
import axios from "axios";

export default {
  name: "App",
  components: {},
  data: function () {
    return {
      input: "",
      fxs: [ "nx", "llr", "ctr" ],
      sizes: [100, 500, 2500],
      dgas: [ 1, 2, 3 ],
      llr_ths: [0.2, 0.5, 1, 1.2, 1.5 ],
      ctr_ths: [0.2, 0.5, 1, 1.2, 1.5 ],
      nx_ths: [0.2, 0.5, 1, 1.2, 1.5 ],
      checkedSizes: [],
      checkedDgas: [],
      checkedFxs: [],
      llr_th: 1,
      ctr_th: 1,
      nx_th: 1,
    };
  },
  created() {
    this.loadFile();
  },
  computed: {
    compiledHtml: function () {
      return this.input;
    },
  },
  methods: {
    reload() {

      console.log(this.checkedSizes, this.checkedFxs, this.checkedDgas, this.llr_th, this.ctr_th, this.nx_th)

      const filename = `${this.llr_th}_${this.ctr_th}_${this.nx_th}.html`

      alert(filename);

      axios({
        method: "get",
        url: `/tables/${filename}`,
      })
        .then((result) => {
          this.input = result.data;
          this.$nextTick().then(()=>{
          this.renderMathJax();
      });
        })
        .catch((error) => {
          console.error("error getting file", error);
        });
    },
    loadFile() {
      axios({
        method: "get",
        url: "/bibo.html",
      })
        .then((result) => {
          this.input = result.data;
        })
        .catch((error) => {
          console.error("error getting file", error);
        });
    },
    renderMathJax () {
      if (window.MathJax) {
        window.MathJax.config  = { 
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        },
        svg: {
          fontCache: 'global'
        }
        }
        window.MathJax.typesetPromise([this.$refs.mathJaxEl])
      }
    }
  },
};
</script>

<style>
#app {
  font-family: Avenir, Helvetica, Arial, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  margin-top: 60px;
}
th,
td {
  vertical-align: top;
}
</style>
