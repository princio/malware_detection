from Pcap import Pcap
from Model import Model
from DomainLevel import DomainLevel
import os
import Paths

def predict_csv(model, pcap, domain_level: DomainLevel):

    print('Predicting with model `%s` pcap `%s` taking the %s-levels of domains...' % (model['name'], pcap['name'], domain_level.name))

    out_csv = '%s_%s_%s.out.csv' % (pcap['path'], model['name'], domain_level.name)
    if not os.path.exists(out_csv):
        model = Model(model['path'])
        model.predict_csv(csv_in_path=pcap['path'], csv_out_path=out_csv, column=pcap['column'], domain_level=domain_level)
        print('Predicted successfuly, csv-out: %s' % out_csv)
    else:
        print('Already predicted, csv-out: %s' % out_csv)
    pass

if __name__ == "__main__":
    model = Paths.model_side
    pcap = Paths.mixed['1']
    predict_csv(model, pcap, DomainLevel.TOP)
    pass