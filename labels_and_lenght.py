from Capture import all_, training
import pandas as pd
from DomainLevel import DomainLevel, extractor


def remove_tld(dn):
    l = dn[:-1*len(extractor(dn).suffix)].count('.')
    return l




if __name__ == "__main__":

    # df = pd.concat([c.dn for c in all_], axis=0, names=['dn']).to_frame()
    # df['points'] = df['dn'].apply(remove_tld)
    # print(df['points'].value_counts())
    # print(df.drop_duplicates()['points'].value_counts())

    df = training.readable
    df['points'] = df['dn'].apply(remove_tld)
    print(df['points'].value_counts())

    print(df.loc[df['label'] == 'legit']['points'].value_counts())
    print(df.loc[df['label'] == 'dga']['points'].value_counts())
    pass