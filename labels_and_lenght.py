from Capture import all_, training
import pandas as pd
from DomainLevel import DomainLevel, extractor


def remove_tld(domain):
    l = domain[:-1*len(extractor(domain).suffix)].count('.')
    return l




if __name__ == "__main__":

    # df = pd.concat([c.domain for c in all_], axis=0, names=['domain']).to_frame()
    # df['points'] = df['domain'].apply(remove_tld)
    # print(df['points'].value_counts())
    # print(df.drop_duplicates()['points'].value_counts())

    df = training.readable
    df['points'] = df['domain'].apply(remove_tld)
    print(df['points'].value_counts())

    print(df.loc[df['label'] == 'legit']['points'].value_counts())
    print(df.loc[df['label'] == 'dga']['points'].value_counts())
    pass