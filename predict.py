from Model import Model, DomainLevel
import numpy as np
import Paths
import csv, os
from plot_num import plot_num
from DataHandler import Predictor, Capture, DataOut

if __name__ == "__main__":
    inputs = '2542116.fls.doubleclick.net,dwgyu36up6iuz.cloudfront.net,4798504.fls.doubleclick.net,clients2.googleusercontent.com,armmf.adobe.com,download.skype.com,evcs-ocsp.ws.symantec.com,gtssl-ocsp.geotrust.com,www.manchesteronline.co.uk,dy48bnzanqw0v.cloudfront.net,dnkzzz1hlto79.cloudfront.net,adclick.g.doubleclick.net,clients2.google.com,r2---sn-2gb7ln7l.gvt1.com,tools.google.com,sw.symcd.com,dff7tx5c2qbxc.cloudfront.net,ardownload.adobe.com,securepubads.g.doubleclick.net,www.independent.co.uk,r13---sn-25g7sm7r.c.pack.google.com'.split(',')

    model_top = Model.from_name('TOP')
    model_side = Model.from_name('SIDE')

    capture = Capture(inputs)
    predictor = Predictor(capture)

    predictor.predict_multi([model_top, model_side], DomainLevel.all())

    # data_out_0 = predictor.predict(model_top, DomainLevel.SUB_TLD, redo=True)
    # data_out_1 = predictor.predict(model_top, DomainLevel.DOM_TLD, redo=True)
    # data_out_2 = predictor.predict(model_side, DomainLevel.SUB_DOM, redo=True)
    # data_out_3 = predictor.predict(model_side, DomainLevel.DOM_SUB, redo=True)


    # with open('/tmp/generic_tot.csv', 'w') as f:
    #     writer = csv.writer(f)
    #     writer.writerow(['#', data_out_0.dl.name, data_out_1.dl.name, data_out_2.dl.name, data_out_3.dl.name ])
    #     writer.writerows([[i, data_out_0.data[idx][DataOut.PREDICTION], data_out_1.data[idx][DataOut.PREDICTION], data_out_2.data[idx][DataOut.PREDICTION], data_out_3.data[idx][DataOut.PREDICTION]] for idx, i in enumerate(inputs)])


    # from CSVInspector import Inspector

    # insp = Inspector()

    # redo = True
    # capture2 = Capture.from_csv(Paths.mixed['1']['path'])
    # predictor2 = Predictor(capture2)

    # data_out_0 = predictor2.predict(model_top, DomainLevel.SUB_TLD, redo=redo)
    # insp.set_data(data.data_out, data.csv_path)
    # insp.group_domains(DomainLevel.SUB_TLD)

    # p1 = data.predict(model_top, DomainLevel.DOM_TLD, redo=redo)
    # insp.set_data(data.data_out, data.csv_path)
    # insp.group_domains(DomainLevel.DOM_TLD)

    # p2 = data.predict(model_side, DomainLevel.SUB_DOM, redo=redo)
    # insp.set_data(data.data_out, data.csv_path)
    # insp.group_domains(DomainLevel.SUB_DOM)

    # p3 = data.predict(model_side, DomainLevel.DOM_SUB, redo=redo)
    # insp.set_data(data.data_out, data.csv_path)
    # insp.group_domains(DomainLevel.DOM_SUB)


    # with open('/tmp/generic_mixed_1_tot.csv', 'w') as f:
    #     writer = csv.writer(f)
    #     writer.writerow(['float', DomainLevel.SUB_TLD.name, DomainLevel.DOM_TLD.name, DomainLevel.SUB_DOM.name, DomainLevel.DOM_SUB.name ])
    #     writer.writerows([[i, p0[idx][0], p1[idx][0], p2[idx][0], p3[idx][0]] for idx, i in enumerate(inputs)])





    pass