import os
import pcap2postgre

infected_path = '/media/princio/ssd512/stratosphere/pcap/dns_pcap/infected'
infected_list = []
for walker in os.walk(infected_path):
    for filename in walker[2]:
        try:
            infected_list.append(filename)
        except:
            print(f'File <{filename}> is empty.')


infected_list = [
    '25-5_2014-03-12_capture-win3.pcap.csv',
    '5_2013-08-20_capture-win14.pcap',
    '7_2013-08-20_capture-win1.pcap',
    '10_2013-08-20_capture-win10.pcap',
    '10_2013-08-20_capture-win9.pcap',
    '25-2_2014-01-25_capture_win3.pcap',
    '6_2013-08-20_capture-win6.pcap',
    '6_2013-08-20_capture-win11.pcap',
    '10_2013-08-20_capture-win7.original.pcap',
    '10_2013-08-20_capture-win7.pcap',
    '110-6_2015-06-07_capture-win9.pcap',
    '32_2017-05-02_normal.only-dns.pcap',
    '32_2017-05-02_normal.pcap',
    '31_2017-05-01_normal.pcap',
    '69_2014-04-07_capture-win17.pcap',
    '303-1_2017-08-12_capture-win2.pcap',
    '30_2017-05-01_normal.pcap',
    '27_2017_04_30-normal.pcap',
    '29_2017-05-01_normal.pcap',
    '71_2014-04-07_capture-win19.fixed.pcap',
    '25-6_2014-12-20_capture-win3.pcap',
    '170-1_capture-win6.pcap'
]

for pcap_path in infected_list:
    pcap2postgre.pcap2postgres(os.path.join(infected_path, pcap_path), infected=True)


normal_path = '/media/princio/ssd512/stratosphere/pcap/dns_pcap/normal'
normal_list = []
for walker in os.walk(normal_path):
    for filename in walker[2]:
        try:
            normal_list.append(filename)
        except:
            print(f'File <{filename}> is empty.')

for pcap_path in normal_list:
    pcap2postgre.pcap2postgres(os.path.join(normal_path, pcap_path), infected=False)
